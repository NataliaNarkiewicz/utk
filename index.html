<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Zmiana koloru głosem</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: sans-serif;
      transition: background-color 0.3s;
    }
    button {
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
    }
    #status, #last {
      margin-top: 15px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1>Powiedz kolor, a tło się zmieni</h1>
  <button id="startBtn">Start nasłuchiwania</button>
  <div id="status">Mikrofon wyłączony</div>
  <div id="last">Ostatnio rozpoznane: —</div>

  <script>
    // Obsługa różnych nazw interfejsu
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    if (!SpeechRecognition) {
      alert("Twoja przeglądarka nie wspiera Web Speech API. Spróbuj w Google Chrome.");
    } else {
      const recognition = new SpeechRecognition();
      recognition.lang = "pl-PL";      // język rozpoznawania
      recognition.continuous = false;  // jedno „nagranie” na raz
      recognition.interimResults = false;

      const startBtn = document.getElementById("startBtn");
      const statusEl = document.getElementById("status");
      const lastEl = document.getElementById("last");

      // Mapowanie polskich nazw kolorów na CSS
      const colorMap = {
        "czerwony": "red",
        "zielony": "green",
        "niebieski": "blue",
        "żółty": "yellow",
        "zolty": "yellow",
        "biały": "white",
        "bialy": "white",
        "czarny": "black",
        "różowy": "pink",
        "rozowy": "pink",
        "pomarańczowy": "orange",
        "pomaranczowy": "orange",
        "fioletowy": "purple",
        "szary": "gray",
        "brązowy": "brown",
        "brazowy": "brown",
        "turkusowy": "turquoise"
      };

      function setBackgroundFromWord(word) {
        const lower = word.toLowerCase().trim();

        // 1. Spróbuj polskiej mapy
        if (colorMap[lower]) {
          document.body.style.backgroundColor = colorMap[lower];
          return true;
        }

        // 2. Spróbuj bezpośrednio jako kolor CSS (np. „red”, „blue”)
        const test = document.createElement("div");
        test.style.color = lower;
        if (test.style.color) {
          document.body.style.backgroundColor = lower;
          return true;
        }

        return false;
      }

      startBtn.addEventListener("click", () => {
        recognition.start();
        statusEl.textContent = "Nasłuchiwanie… Powiedz nazwę koloru.";
      });

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        lastEl.textContent = "Ostatnio rozpoznane: " + transcript;

        const success = setBackgroundFromWord(transcript);
        if (!success) {
          statusEl.textContent = "Nie rozpoznano koloru: " + transcript;
        } else {
          statusEl.textContent = "Kolor ustawiony na podstawie: " + transcript;
        }
      };

      recognition.onerror = (event) => {
        statusEl.textContent = "Błąd rozpoznawania: " + event.error;
      };

      recognition.onend = () => {
        // kończy nasłuchiwanie
      };
    }
  </script>
</body>
</html>
